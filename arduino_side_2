// OGP -- ARDUINO SIDE V2.0
// in this version, all of the timing is left up to the rpi
// for use with any serial device over usb
// this config handles:  2 SERVOS, and 1 MOTOR

#include <Servo.h>
#include <AFMotor.h>

static int const SERVO_STOP = 90;
static int const SLOW_CW = 87; //CW = Clockwise
static int const FAST_CW = 85;
static int const SLOW_CCW = 93; //CCW = CounterClockwise
static int const FAST_CCW = 95;
static int const MOTOR_STOP = 0;
static int const MOTOR_FULL = 255;
static int const MOTOR_HALF = 128;

char val = 'n';         // variable to receive data from the serial port

Servo myservo;         // create servo objects
Servo myservo2;
AF_DCMotor motor(2);     //create dc motor object

void setup()
{
  myservo.attach(9);         // attaches the servo on pin 9 to the servo object
  myservo2.attach(10);

  motor.setSpeed(MOTOR_STOP);         // just to make sure the motor is stopped
  motor.run(RELEASE);


  Serial.begin(9600);    // start serial communication at 9600bps
}

void loop() {

  if( Serial.available() )       // if data is available to read
  {
    val = Serial.read();         // read it and store it in 'val'
  }

  switch( val )        //switch handles incoming signal
{

        case 'f':                      //   focus  1
        motor.setSpeed(MOTOR_FULL);
        motor.run(FORWARD);
        Serial.println("focus 1");
        break;

        case 'c':                  // focus stop
        motor.run(RELEASE);
        Serial.println("focus stop");
        break;

        case 't':                  // focus 2
        motor.setSpeed(MOTOR_FULL);
        motor.run(BACKWARD);
        break;


        case '1':                         //  directionals  X
        myservo.write(FAST_CCW);
        Serial.println("1 - CounterClockwise Fast");
        break;

        case '2':
        myservo.write(SLOW_CCW);
        Serial.println("2 - CounterClockwise");
        break;

        case '3':               // stopped
        myservo.write(SERVO_STOP);
        Serial.println("3 - Stop x");
        break;

        case '4':
        myservo.write(SLOW_CW);
        Serial.println("8 - Clockwise");
        break;

        case '5':
        myservo.write(FAST_CW);
        Serial.println("9 - Clockwise Fast");
        break;

        case '6':                           // Y
        myservo2.write(FAST_CCW);
        Serial.println("7 - down fast");
        break;

        case '7':
        myservo2.write(SLOW_CCW);
        Serial.println("7 - down");
        break;

        case '8':
        myservo2.write(SERVO_STOP);
        break;

        case '9':
        myservo2.write(FAST_CW);
        Serial.println("9 - up");
        break;

        case '0':
        myservo2.write(SLOW_CW);
        Serial.println("0 - up fast");
        break;

        case 'n':
        myservo2.write(SERVO_STOP);
        myservo.write(SERVO_STOP);
        Serial.println("all stop");
        break;


        default :              // catches exceptions
        myservo.write(SERVO_STOP);
        myservo2.write(SERVO_STOP);
        Serial.println("default");


}

}
// (c) Copyright 2014   C. Robert Barnett III
